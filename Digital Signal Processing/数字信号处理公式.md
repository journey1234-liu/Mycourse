# 数字信号处理公式

## 滤波器设计

### 模拟IIR

低通的指标

阶数N:

$N \ge lg[\frac{10^{0.1A_{st}}-1}{10^{0.1R_p}-1}]/2lg(\frac{\Omega_{st}}{\Omega_p})$

截止频率$\Omega_c$

$\Omega_c = \Omega_p/\sqrt{10^{0.1R_p}-1}$



四种滤波器的步骤

#### 模拟低通

给定：$f_p,f_{st},A_{st},R_p$

1. $\Omega_p=2\pi f_p,\Omega_{st} = 2\pi f_{st}$
2. 算N，算$\Omega_c$
3. 查表得$H_{an}(s)$
4. $H_{a}(s) = H_{an}(\frac{s}{\Omega_c})$



#### 模拟高通

给定：$f_p,f_{st},A_{st},R_p$

1. $\Omega_p=2\pi f_p,\Omega_{st} = 2\pi f_{st}$
2. $\bar{\Omega}_p = 1,\bar{\Omega}_{st}=-\frac{\Omega_p}{\Omega_{st}}$
3. 算N，算$\bar{\Omega}_c$
4. 查表得出$H_{an}(\bar{s})$
5. $H_a(\bar{s})=H_{an}(\frac{\bar{s}}{\bar{\Omega}_c})$
6. $H_{a}(\bar{s}) = H_a(\bar{s})|_{\bar{s}=\frac{\Omega_p}{s}}$



#### 模拟带通

给定：$f_{p1},f_{p2},f_{st1},f_{st2},R_{p},A_{st}$

1. 计算$\Omega_{p1},\Omega_{p2},\Omega_{st1},\Omega_{st2}$
2. $\bar{\Omega}_p=1$，归一化，计算$\bar{\Omega}_{st}$。$B_p=|\Omega_{st1}-\Omega_{st2}|$,$\Omega_{p0}=\sqrt{\Omega_{p1}\Omega_{p2}}$

$\bar{\Omega}_{st1}=\frac{\Omega_{st1}^2-\Omega_{p0}^2}{\Omega_{st1}B_p}$，$\bar{\Omega}_{st2}$同理，$\bar{\Omega}_{st} = min\{\bar{\Omega}_{st1},\bar{\Omega}_{st2}\}$

3. 用$\bar{\Omega}_{st},\bar{\Omega}_{p}$算$N$和$\bar{\Omega}_{c}$
4. 查表得$H_{an}(\bar{s})$
5. $H_a(\bar{s})=H_{an}(\frac{\bar{s}}{\bar{\Omega}_c})$
6. 频带变换：$H_{bp}(s)= H_a(\bar{s})|_{\bar{s}=\frac{s^2+\Omega_{p0}^2}{s*B_p}}$



#### 模拟带阻

给定：$f_{p1},f_{p2},f_{st1},f_{st2},R_{p},A_{st}$

1. 计算$\Omega_{p1},\Omega_{p2},\Omega_{st1},\Omega_{st2}$
2. $\bar{\Omega}_p=1$，归一化，计算$\bar{\Omega}_{st}$。$B_s=|\Omega_{p1}-\Omega_{p2}|$,$\Omega_{st0}=\sqrt{\Omega_{st1}\Omega_{st2}}$

$\bar{\Omega}_{p1}=\frac{\bar{\Omega}_{st}B_s\Omega_{p1}}{\Omega_{st0}^2-\Omega_{p1}^2}$，$\bar{\Omega}_{p2}$同理，此处得到关于$\bar{\Omega}_{st}$的表达式，$\bar{\Omega}_{p} = max\{\bar{\Omega}_{p1},\bar{\Omega}_{p2}\}$

令$\bar{\Omega}_p=1$，解出$\bar{\Omega}_{st}$

以上，得到归一低通指标

3. 用$\bar{\Omega}_{st},\bar{\Omega}_{p}$算$N$和$\bar{\Omega}_{c}$
4. 查表得$H_{an}(\bar{s})$
5. $H_a(\bar{s})=H_{an}(\frac{\bar{s}}{\bar{\Omega}_c})$
6. 频带变换：$H_{bs}(s)= H_a(\bar{s})|_{\bar{s}=\frac{s*B_s*\bar{\Omega}_{st}}{s^2+\Omega_{st0}^2}}$



### 数字IIR

#### 冲击响应不变法

不能设计高通和带阻

需要频率响应严格带限于$\frac{f_s}{2}$

步骤：

1. 前面步骤和模拟相同，得到$H_a(s)$
2. 将$H_a(s)$展开为部分分式$\sum_{k=1}^{N}\frac{A_kT}{s-s_k}$
3. 代入公式$H(z)=L[T*h_a(nT)]=L[h(n)]=\sum_{k=1}^{N}\frac{A_kT}{1-e^{s_kT}z^{-1}}$。其中sk为系数



#### 双线性变换法

需要预畸$\Omega=\frac{2}{T}tan(\frac{\omega}{2})$

T随便取，一般取2

$s=\frac{1-z^{-1}}{1+z^{-1}}*\frac{2}{T}$

步骤

1. 获取数字角频率 $\omega_p=\frac{\Omega_p}{f_s},\omega_{st}=\frac{\Omega_{st}}{f_s}$
2. 预畸得到模拟的频率：$\Omega_p'=tan\frac{\omega_p}{2},\Omega_{st}'=tan\frac{\omega_{st}}{2}$，注意说明 $T=2$
3. 求出N和截止频率$\Omega_c'$
4. 得到对应的模拟滤波器
5. 双线性变换：$H(z)=H(s)|_{s=\frac{1-z^{-1}}{1+z^{-1}}}$
6. 对于带通带阻滤波器，所有角频率都需要预畸



#### 直接变换法

用双线性变换法直接将模拟低通变到其他的滤波器

##### 数字低通

与双线性变换法一致



##### 数字高通

$s=\frac{1+z^{-1}}{1-z^{-1}}$

$\Omega=cot\frac{\omega}{2}$

给定$f_{st},f_p,f_s,A_{st},R_p$

步骤：

1. 计算$\omega_p=\frac{2\pi f_p}{f_s},\omega_{st}=\frac{2\pi f_{st}}{f_s}$
2. 预畸 $\Omega_p=cot\frac{\omega_p}{2},\Omega_{st}=cot\frac{\omega_{st}}{2}$
3. 计算N和截止频率
4. 去归一化得到$H_{hp}(z)=H_a(s)|_{s=\frac{1+z^{-1}}{1-z^{-1}}}$



##### 数字带通

$cos\omega_0=\frac{cos(\frac{\omega_{p1} + \omega_{p2}}{2})}{cos(\frac{\omega_{p1} - \omega_{p2}}{2})}$ 注意大减小

$s=\frac{1-2z^{-1}cos\omega_0+z^{-2}}{1-z^{-2}}$

$\Omega=\frac{cos\omega_0-cos\omega}{sin\omega}$

给定$f_{st1},f_{st2},f_{p1},f_{p2},f_s,A_{st},R_p$

步骤：

1. 获得 $\omega_{p1},\omega_{p2},\omega_{st1},\omega_{st2},$
2. 获取中心频率 $cos\omega_0=\frac{cos(\frac{\omega_{p1} + \omega_{p2}}{2})}{cos(\frac{\omega_{p1} - \omega_{p2}}{2})}$
3. 获得模拟频率：

$\Omega_p=\frac{cos\omega_0-cos\omega_{p2}}{sin\omega_{p2}}$注意选择更远的频率$\omega_{p2}$

$\Omega_{st1}=\frac{cos\omega_0-cos\omega_{st1}}{sin\omega_{st1}}$

$\Omega_{st2}=\frac{cos\omega_0-cos\omega_{st2}}{sin\omega_{st2}}$

$\Omega_{st}=min(|\Omega_{st1}|,|\Omega_{st2}|)$

4. 计算N和截止频率
5. 去归一化获得$H_a(s)$
6. 直接转换：$H_{bp}(z)=H_a(s)|_{s=\frac{1-2z^{-1}cos\omega_0+z^{-2}}{1-z^{-2}}}$



##### 数字带阻

$cos\omega_0=\frac{cos(\frac{\omega_{p1} + \omega_{p2}}{2})}{cos(\frac{\omega_{p1} - \omega_{p2}}{2})}$ 注意大减小，和带通是一样的

$s=\frac{1-z^{-2}}{1-2z^{-1}cos\omega_0+z^{-2}}$

$\Omega=\frac{sin\omega}{cos\omega_0-cos\omega}$

给定$f_{st1},f_{st2},f_{p1},f_{p2},f_s,A_{st},R_p$

步骤：

1. 获得 $\omega_{p1},\omega_{p2},\omega_{st1},\omega_{st2},$
2. 获取中心频率 $cos\omega_0=\frac{cos(\frac{\omega_{p1} + \omega_{p2}}{2})}{cos(\frac{\omega_{p1} - \omega_{p2}}{2})}$
3. 获得模拟频率：

$\Omega_{st}=\frac{sin\omega_{st1}}{cos\omega_0-cos\omega_{st1}}$注意选择更近的频率 $\omega_{st1}$

$\Omega_{p1}=\frac{sin\omega_{p1}}{cos\omega_{p1}-cos\omega_0}$

$\Omega_{p2}=\frac{cos\omega_0-cos\omega_{p2}}{sin\omega_{p2}}$

$\Omega_{p}=max(|\Omega_{p1}|,|\Omega_{p2}|)$

4. 计算N和截止频率
5. 去归一化获得$H_a(s)$
6. 直接转换：$H_{bs}(z)=H_a(s)|_{s=\frac{1-z^{-2}}{1-2z^{-1}cos\omega_0+z^{-2}}}$

### 数字FIR

单位冲击响应奇偶对称，范围N奇数偶数，有4种组合方式

窗函数设计

N奇对偶

可以设计任意滤波器

N奇对奇

N偶对偶

N偶对奇



单位抽样响应：

低通

$h_d(n)=\frac{sin[\omega_c(n-\tau)]}{\pi(n-\tau)}, n\neq\tau$

$h_d(n)=\frac{\omega_c}{\pi}n=\tau$

高通

$h_d(n)=-\frac{sin[\omega_c(n-\tau)]}{\pi(n-\tau)},\quad n\neq\tau$

$h_d(n)=1-\frac{\omega_c}{\pi},\quad n=\tau$

带通

$h_d(n)=\frac{1}{\pi(n-\tau)}\{ sin[\omega_2(n-\tau)]-sin[\omega_1(n-\tau)]\},\quad n\neq \tau$

$\frac{\omega_2-\omega_1}{\pi},\quad n=\tau$

带阻

$h_d(n)=\frac{1}{\pi(n-\tau)}\{sin[\pi(n-\tau)]- sin[\omega_2(n-\tau)]+sin[\omega_1(n-\tau)]\},\quad n\neq \tau$

$1-\frac{\omega_2-\omega_1}{\pi},\quad n=\tau$



窗函数设计法步骤：

给定 $\omega_p,\omega_{st},R_p,A_{st}$

1. 计算理想线性相位滤波器

![](E:\sjtu study\Curriculum\Digital_Signal_Processing\fig\参数.png)

![](E:\sjtu study\Curriculum\Digital_Signal_Processing\fig\FIR.png)

2. 根据$A_s$选择相应的窗，由窗的长度表达式计算N，得到w（n）
3. $h(n)=h_d(n)w(n)$，$h_d(n)$由滤波器类型得到。
4. 检验是否符合要求（一般都是符合的）











