# DIP总结

<img src=".\fig\main.png" style="zoom: 50%;" />

总结完毕之后可以回头看看第一章PPT。

[TOC]

## 第一章

### 图像处理步骤：

1.问题域确定，系统构建

2.图像采集

3.图像增强

4.图像复原

5.形态学处理

6.特征表达

7.图像识别（行为识别&分析）

分析典型案例：车牌识别系统

### 传感器成像：

1.单色成像：光->镜片->感光器

2.RGB成像： 通过拜耳滤镜或者多传感器

### 图像：

黑白图像：非0即1

灰度图：0~255对应黑到白色

RGB图：三通道



## 第二章：基础知识

### 彩色三要素：

1.亮度，取决于光线的强弱（光强度，光度，照度，光通量）

2.色调：取决于光的波长

3.色饱和度：取决于某色光中掺入白光的比例

三基色：红绿蓝（显像三基色）

混色法：用三基色按照不同比例来混合获得彩色的方法

### 颜色模型

RGB模型：

<img src="fig\RGB.png" style="zoom:80%;" />

HSI模型： 色度(Hue)光强度(Intensity)和饱和度(Saturation)

*两种模型的非线性映射

处理流程

<img src="fig\2处理流程.png" style="zoom:80%;" />

### 采样和量化

采样：空间坐标的数字化

量化：取值的数字化

一般采用均匀采样

密采样：在灰度突变区，为了不丢失细节

稀采样：在灰度平缓区

密量化：在灰度平缓区，防止产生虚假轮廓

稀量化：灰度剧变区，人眼对灰度剧变的边缘区灰度分辨力低



### 像素的空间关系

#### 邻域：4邻域，8邻域，对角邻域

**判断两个像素是否连接：空间上邻接且像素灰度值相似**

#### 连接：4连接，8连接，m连接

注意m连接，是为了消除8连接的歧义性。有4连接就用4连接，4连接没有就看是否有8连接。

<img src="fig\2连接.png" style="zoom:80%;" />

#### 通路：由连接得来的一组像素

4-通路；8-通路；m-通路

#### 连通：

通路上的所有像素灰度值满足相似准则

#### 连通域：

**1.所有像素的灰度级别均小于或等于连通域的级别**

**2.同一个连通域中的像素两两相连通即在任意两个像素之间存在一条完全由这个集合的元素构成的通路**

多连通域：**复平面上的一个区域B，如果在其中任作一条简单闭曲线，而曲线的内部不总属于B**

个人理解：多连通域，像素之间存在在拓扑上不相同的路径

边沿（缘）：**超过某个灰度阈值的所有像素点组成，是基于灰度级不连续性的测度。可把其看作图像强度的不连续性**

一般来说，边沿是在图像的某个地方灰度值发生剧烈的变化

#### **连通域的获取方法**

个人想法：从一个像素点开始往外延伸至无符合的像素点，类似于种子填充法。

https://blog.csdn.net/icvpr/article/details/10259577

#### 像素的距离

距离的性质：非负，对称，三角不等式

欧氏距离：开方运算（圆形分布）

城区距离（曼哈顿距离）：横加纵（菱形分布）

棋盘距离：横纵差的最大值（方形分布）

$D_4$距离 $D_8$距离 ：不需要考虑它们之间通路的值

$D_m$距离：需要看它们之间像素的值

<img src="fig\2距离.png" style="zoom:80%;" />

### 像素的运算

#### 算术运算

加：去除高斯加性噪声，拼接半透明图片

减：去除叠加图案，背景图案，检测图案的变化

乘：局部显示图像

除：校正由于照明或传感器的非均匀性造成的图像灰度阴影

#### 逻辑运算

与，或，异或，非。此处不再赘述



点运算，邻域运算



#### 几何变换

平移

缩放：需要进行插值或者抽取

镜像，旋转，形变



## 第三章 形态学处理

用指定的结构元素，在图像上运算

基本概念：

A为物体区域，B为结构元素

三种关系：B包含于A，B击中A，B击不中A



### 基本运算

#### 腐蚀

用一个结构元素去探测图像的内部，找出可以放下该元素的区域，类似于收缩图像

<img src="fig\2腐蚀数学形式.png" style="zoom:80%;" />

![](E:\sjtu study\Curriculum\Digital_Image_Processing\fig\腐蚀.png)

#### 膨胀

腐蚀的对偶运算，看例子会有直观的感受

<img src="fig\2膨胀数学形式.png" style="zoom:80%;" />

<img src="fig\2膨胀.png" style="zoom:80%;" />

#### 开运算

先腐蚀再膨胀

**平滑图像的轮廓，削弱狭窄的部分，去掉细的突出毛刺和孤立斑点**

个人理解：平滑外凸的轮廓，去掉突出和孤立斑点

#### 闭运算

先膨胀再腐蚀

**熔合窄的缺口和细长的弯口，去掉小洞，填补轮廓上的缝隙**

个人理解：平滑内凹的轮廓，去掉内部的洞

#### 应用例子

<img src="fig\2例子1.png" style="zoom:80%;" />

<img src="fig\2例子2.png" style="zoom:80%;" />

##### 边缘提取

<img src="fig\2例子3.png" style="zoom:80%;" />

<img src="fig\2例子4.png" style="zoom:80%;" />

##### 击中击不中变换：

**探测区域中同时具有目标和目标背景的物体，即为寻找的特定目标**

<img src="fig\2击中击不中.png" style="zoom:80%;" />

用所需元素本身和它的背景去腐蚀图像和图像的补集，得到两个图像的交集对应的位置就是所需元素。

##### 细化

**把结构元素在图像中移动，子元素的阴影完全包含于物体中，而白色区域则完全包含于物体的背景中，则该子元素击中物体，从图像中取出该点**

是一个连续的过程

<img src="fig\2细化.png" style="zoom:80%;" />

##### 粗化

细化的对偶



#### 灰值运算

灰值腐蚀，灰值膨胀

灰值开闭运算（用于滤波）

灰值开运算：去除椒盐噪声中的亮点（盐点）

灰值闭运算：去除椒盐噪声中的暗点（椒点）

其他算法：

top-hat高帽变换：**在较亮的背景中求暗的像素聚集体(颗粒)在较暗的背景中求亮的像素聚集体**

bot-hat低帽变换：**在较亮的背景中求暗的像素点**



## 第四章：图像增强

<img src="fig\4思维导图.png" style="zoom:80%;" />

### 点运算

不会改变图像内像素点之间的空间关系

#### 灰度变换：

一.线性

1.求反

2.对比度增强：增加某两个灰度值的灰度值范围

3.阈值化

4.灰度切分：将某个范围的灰度值突出，其他的保留

二.非线性



#### 灰度直方图

**灰度级和出现这种灰度的概率之间的关系。用概率密度函数来表示原始图像的灰度分布**

直方图给出了整体描述，但是没有位置信息

##### **修整直方图**

##### 均衡化

增加灰度值的动态范围

灰度变换函数应该满足：

1.函数在$0 \le s \le L-1$范围内是**单值单增**函数

2.保证动态范围的一致性

注意例题PPT31

计算：将原本不同灰度值的像素组就近分配为不同的新的灰度值

##### 规定化

将原来的直方图变成**规定形状**的直方图

PPT44例题



### 邻域运算

用模板运算

#### 平滑（主要了解思想即可）

实质上是低通滤波，会模糊边缘

<img src="fig\4平滑算法.png" style="zoom:80%;" />

1. 邻域平均：抑制随机噪声

2. 中值滤波：抑制椒盐噪声（噪声点不多），可以保护边缘，非线性

3. k近邻：K取的小，细节保持较好，K取得大，平滑噪声较好

4. 梯度倒数加权：把梯度绝对值的倒数作为权重

5. 最小均方差：比较用不同的模板的均值和方差，使用最小方差的模板的灰度均值。

<img src="fig\4最小方差.png" style="zoom:80%;" />

#### 锐化

1. **梯度处理**，如果直接选择坐标处的梯度，在比较平缓的区域，会很黑。最好选择一个门限值，分别计算，可以借此研究边界的位置。

   梯度的选取可以是水平，垂直，或者两个方向的平方平均值

2. **锐化算子**

   Sobel算子

   <img src="fig\4sobel.png" style="zoom:80%;" />

<img src="fig\4锐化算子.png" style="zoom:80%;" />

​		prewitt算子

<img src="fig\4prewitt.png" style="zoom:80%;" />



​		二阶微分算子：拉普拉斯算子



真彩色增强步骤：

1. RGB转换为HSI
2. 用灰度图增强的方法增强I分量
3. 转换回RGB

伪彩色增强

把人无法分辨的灰度变换变成不同的彩色

1.亮度切割

2.灰度级到彩色的变换（安检，遥感）

3.频率域滤波

## 第五章：图像变换与频域滤波

### 图像变换定义：

将图像从空域变到其他域（频域）的数学变换。

![](fig\5.3.png)

### 傅里叶变换

#### 狄利赫里条件：

1. 有限个间断点
2. 有限个极值点
3. 绝对可积

#### 傅里叶变换作用：

1. 得出信号在各个频率点上强度
2. 将卷积运算变换为乘法
3. 傅里叶变换和线性系统理论是进行图像恢复和重构的重要手段
4. 从频域角度来看待图像

### 离散余弦变换（DCT）

为了减少数据量（相对于傅里叶变换）

DCT系数的规律性：

1. 系数非零的频率由高到低
2. 系数绝对值由大到小
3. 非零系数间的间隔由小到大

**块内像素变化平缓，相关性越强，这种分布规律越明显，能量越集中；** 

应用：

图像压缩（JPEG格式，静止图像压缩标准）

JPEG的应用例子

![](fig\5DCT例子.png)

保留右上角低频（主要能量），舍弃高频（幅值近似0），图像在视觉上是基本不变的，而且清晰度比较高

### 沃尔什哈达玛变换（Walsh-Hadamard）

基函数是方波的变形

一维

二维沃尔什变换计算例题（PPT22），自行计算第二小问

![](fig\5DWT1.png)

沃尔什核矩阵的行和列都是正交的

沃尔什变换本质上把一个函数变为取值为+1或者-1的基向量构成的级数

原始数据越均匀，变换之后的数据越集中于边角。

哈达玛：沃尔什变换的矩阵重构形式，仍然满足行列的正交性

![](fig\5DHT.png)

### 频域图像滤波与增强

#### 通带滤波

##### 低通滤波

1. 理想滤波(ILPF)，缺点：图像模糊，出现振铃效果
2. 巴特沃斯(BLPF)，它的带通与带阻之间无明显的不连续性，因此无振铃现象，模糊程度减少，它的尾部有较多的高频，通过下降它的截止频率达到一些平滑效果。
3. 指数低通(ELPF)，过渡带更平滑， 无振铃现象，比巴特沃斯衰减更快更模糊
4. 梯形低通（TLPF）

![](fig\5滤波器.png)

##### 高通滤波

对应四种低通滤波器

**带通或带阻滤波器**

对特定频段的信息进行增强或者抑制

**图像的同态增晰**

同时将图像的亮度范围进行压缩，将对比度增强。

增加了暗区的细节，不损失亮区的细节。

步骤：

1. 把图像分为高频区（反射分量）和低频区（照射分量），取对数
2. 傅里叶变换
3. 同态滤波函数（压缩照度分量的灰度范围/在频域上削弱照度分量。增强反射分量的对比度/在频域上加强反射频谱部分），一般是高通滤波器的变形
4. 还原图像

![](fig\5同态滤波.png)

## 第六章：图像分割

### 阈值分割

用一个特定的灰度阈值分割区域，阈值过高（太白）则很多目标点被归为背景，过低（太黑）则背景会被判定为目标。

模型：处于目标和背景处交界处的两边的像素在灰度值上有很大差别，但是目标和背景内部的相邻像素的灰度值是高度相关的。

阈值可以设置为全局阈值和自适应阈值

#### 双峰法

灰度直方图呈现明显的双峰状，谷底的灰度为阈值。

缺点：容易受到噪声影响，不适合双峰不明显或者谷比较宽的图像

#### 最佳阈值法

错误最小的阈值，基础是贝叶斯最小误差分类法

![](fig\6bayes.png)

假如图像的目标物和背景象素灰度级概率呈正态分布，且偏差相等（方差相等），背景和目标物象素总数也相等。最佳分割阈值就是目标物和背景象素灰度级两个均值的平均。

#### 迭代法

通过不断的迭代将阈值逼近两个区域的均值的平均。

步骤

1. 求出最大最小灰度值，初始灰度值是它们的平均
2. 分割图像
3. 求出两个区域的平均灰度值$\mu_1,\mu_2$
4. 计算新的阈值
5. 如果新的阈值和旧的阈值差小于临界值，则迭代结束

#### 最大类间方差法（大津法）

目标：两部分方差最大，即分离性最大

需要遍历最小到最大的灰度值

#### **最大熵阈值分割法** 

通过灰度分布密度函数定义信息熵，使用不同的熵准则，最后优化

一维：使阈值分割出的一阶灰度统计的**信息量**最大

![](fig\6熵.png)

优点：不需要先验知识，非理想的双峰图也可以用

缺点：只利用了点灰度信息，易受噪声影响，SNR降低时分割效果不理想

二维：

利用了图像邻域的信息，抗噪能力强一些

![](fig\6二维熵.png)

一些结论：

1. 二维直方图在SNR较低时，双峰仍然明显
2. 概率高峰主要出现在XOY的对角线附近：双峰一谷，远离对角线处是噪声点，边缘点和杂散点
3. 在A区和B区用二维最大熵法确定最佳阈值，使目标和背景的信息量最大 （？）

#### **动态自适应阈值分割**

对子图像进行分割，使用不同的阈值

#### 分水岭算法

1. 基于距离变换。是用每个像素到最近非零值像素的欧氏距离取代灰度。
2. 基于梯度，需要梯度平滑
3. 基于标记。添加标记符对梯度图像进行预处理，将对应内部标记符与外部标记符的区域置为最小值



### 边缘检测

**高斯-拉普拉斯(LOG)算子** 

把高斯平滑滤波器和拉普拉斯锐化滤波器结合起来，先平滑掉噪声，再进行边缘检测。

坎尼算子（canny）

**最为优秀的边缘检测器。**

基于三个目标：

1. 低错误率
2. 边缘点被很好地定位
3. 单一边缘点响应

算法步骤：

1. 消除噪声（2D高斯滤波）
2. 找到图像灰度沿着两个方向的偏导数，以及梯度的大小和方向。
3. 由边缘梯度的方向将边缘梯度划分为4种八个方向![](fig\6canny.png)
4. 非最大值抑制：遍历图像，若某个像素的梯度值与其梯度方向上前后两个像素的梯度值相比不是最大的，那么这个像素值置为0，即不是边缘
5. 取两个阈值：

（1） 高阈值和低阈值的步比率应为2；1或者3；1.

（2） 凡是大于高阈值的是边缘，小于低阈值的不是

（3） 在两个阈值之间的，看邻接像素有没有超过高阈值的像素，有就是边缘。



### 霍夫检测

将笛卡尔坐标空间的线变换为极坐标空间中的点

实质：原始图像中给定形状的曲线和直线上的所有点都集中到变换空间的某个点上形成**峰值点**。这样，将原始图像中给定形状的曲线或直线的检测问题，变成**寻找变换空间中的峰值点问题**。

#### 笛卡尔空间

图像空间的线对应霍夫空间的一个点，图像空间的一个点对应霍夫空间的一条线。

**原理**：过点A$(x_0,y_0)$的所有直线均满足$y_0 = kx_0 +b$，那么在参数空间里面，$b = -k*x_0+y_0$这条直线就对应点A

Hough空间中两条线的交点用来表示过点$(x_0,y_0),(x_1,y_1)$的直线。

![](fig\6霍夫.png)

存在的问题：不能表示垂线，因为斜率为无穷大。

解决方法：极坐标表示

#### 极坐标表示

原理：参数空间$(\rho,\theta)$,垂线可以表示为$r=x_0$。参数具体形式为$r= x_0\cos{\theta} + y_0\sin{\theta}$。

把在图像空间中检测直线的问题转化为在极坐标参数空间中找通过点$(r,\theta)$的最多正弦曲线数的问题。

圆检测和正弦曲线检测可以自学



### 区域分割

#### 区域生长

1. 选择一个种子像素
2. 从邻域中选出性质相同或者相似的像素进行合并
3. 新的像素作为种子像素，迭代

**基于区域灰度差方法**（直接比较像素的灰度）

1. 找出没有归属的像素
2. 检查邻域像素，**如果灰度差小于预先确定的阈值T，将它们合并**
3. 以新的像素为种子，迭代

**基于区域内灰度分布统计性质**（比较像素区域的灰度）

1. 把像素分为互不重叠的小区域
2. 比较邻接区域的累计灰度直方图，根据灰度分布相似性进行合并

**使用此方法，划分的小区域的尺寸对结果可能有较大影响。尺寸太** 

**小时检测可靠性降低，尺寸太大时得到的区域形状不理想，小的目** 

**标会被漏掉。**

**使用Smoothed-Difference方法检测直方图相似性时效果好于K-S** 

**检测，原因是考虑了所有的灰度值**

![](fig\6生长.png)

#### 分裂合并

加入了分裂的检测

1. 如果区域的方差大于阈值，则将区域四等分
2. 相邻区域并集的方差小于阈值，则合并
3. 不满足1,2则终止算法

可以通过四叉树操作

**由于噪声影响或者按照四叉树划分区域边缘未对准，进行上述操作后可能仍** 

**存在大量的小的区域，为了消除这些影响，可以将它们按照相似性准则归入** 

**邻近的大区域内。**

### **主动轮廓线模型(SNAKE模型)** 

通过类比弹性曲线的收缩来理解

曲线包含内部能量（弹性势能和弯曲势能）以及外部能量（**由计算图像的灰度、边缘等特征获得，它用来吸引曲线的边缘轮廓**）。

![](fig\6弹性.png)

![](fig\6弯曲.png)

总能量最小即为终止条件

弹性力使图像收缩为一个点，弯曲力使图像收缩为一个圆

**传统snake模型中，外力是吸引曲线到目标轮廓附近的关键因素，因此，目前大多数研究人员对snake模型的改进都是集中在如何设计一个好的外力上。** 